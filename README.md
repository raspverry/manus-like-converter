# Perl-Python 自動変換エージェント

## 概要

このプロジェクトは Manus 風 AI エージェントをベースにした、自律的なプログラミング言語変換システムです。特に Perl から Python へのコード変換に特化しており、元のコードの機能を維持しながら、Python の慣用的な書き方に従った変換を行います。

## 主な特徴

1. **自律的な変換プロセス**：
   - コードの分析
   - 変換計画の作成
   - 段階的なコード変換
   - 自動テストと検証
   - エラー修正と最適化

2. **強化されたコード分析**：
   - Perl コードの構造解析
   - 依存関係のマッピング
   - 特殊な Perl 構文の識別

3. **インテリジェントな変換**：
   - Perl の特殊変数を適切に変換
   - Perl 特有のイディオムを Python 風に変換
   - コメントと文書構造の保持

4. **自動テストと検証**：
   - 変換されたコードをサンドボックスで実行
   - 元のコードとの機能的等価性確認
   - エラーの自動修正

5. **強化されたメモリシステム**：
   - 元のコードと変換後のコードの関係を追跡
   - 変換パターンの学習と再利用

## 必要条件

- Python 3.12 以上
- Docker （サンドボックス実行環境用）
- OpenAI API のアクセスキー

## インストール方法

1. リポジトリをクローン：
```bash
git clone https://github.com/raspverry/manus-like-converter.git
cd perl-python-converter
```

2. 依存パッケージをインストール：
```bash
uv add -r requirements.txt
```

3. `.env` ファイルを作成し、API キーを設定：
```
OPENAI_API_KEY=your_openai_api_key
# 使用するモデルを指定（例：gpt-4o、gpt-3.5-turbo など）
LLM_MODEL=gpt-4o
```

4. サンドボックス環境の Docker イメージをビルド：
```bash
cd sandbox
docker build -t perl-python-sandbox:latest .
cd ..
```

## 使用方法

### コマンドライン

```bash
python convert.py --input your_perl_script.pl --output converted_script.py
```

オプション：
- `--input` : 変換する Perl スクリプトのパス（必須）
- `--output` : 出力する Python スクリプトのパス（オプション、デフォルトは入力ファイル名.py）
- `--detailed` : 詳細な変換プロセスを表示
- `--test` : 変換後のコードをテストして結果を表示

### Web UI

1. Web インターフェースを起動：
```bash
python main.py --ui streamlit
```

2. ブラウザで `http://localhost:8501` にアクセス

3. Perl コードをアップロードまたは貼り付け

4. 「変換」ボタンをクリック

## 変換プロセスの詳細

1. **分析フェーズ**：
   - Perl コードを PPI を使用して解析
   - コード構造と構文要素を特定
   - 変数、関数、モジュールの依存関係をマッピング

2. **計画フェーズ**：
   - 変換手順の詳細計画作成
   - 変換が難しい構造の特定
   - 変換方法の決定

3. **変換フェーズ**：
   - セグメントごとにコードを変換
   - Perl 特有の構造を Python 相当に変換
   - コメントと文書構造の保持

4. **テストフェーズ**：
   - 変換されたコードをサンドボックスで実行
   - 発生したエラーの自動修正
   - 元のコードとの出力比較

5. **最適化フェーズ**：
   - コードの Python 風の最適化
   - 重複排除とリファクタリング
   - コードスタイルの調整

## サポートされている Perl 機能

- 基本的な構文要素（変数、制御構造、関数）
- 特殊変数（$_, @_, %ENV など）
- 正規表現
- ファイル操作
- モジュールと名前空間
- オブジェクト指向構造
- 例外処理

## Perl から Python への主な変換マッピング

| Perl | Python |
|------|--------|
| ハッシュ（%hash） | 辞書（dict） |
| 配列（@array） | リスト（list） |
| リファレンス | オブジェクト |
| 正規表現 | re モジュール |
| ファイルハンドル | ファイルオブジェクト |
| Perl モジュール | Python モジュール/パッケージ |
| 特殊変数 | Python の適切な同等物 |
| Perl OOP | Python クラス |

## 制限事項

- 非常に複雑な Perl 構文や言語固有の深い部分は完全に変換できない場合があります
- XS（C言語拡張）を使用するモジュールは直接変換できません
- 特定の Perl 専用モジュールの機能は、Python の同等のライブラリが存在しない場合があります
- パフォーマンス特性は変換後に異なる場合があります

## 次のステップと拡張可能性

1. **複雑なモジュールサポート**：より複雑な Perl モジュールの変換サポート向上
2. **双方向変換**：Python から Perl への変換機能の追加
3. **その他の言語サポート**：Ruby, PHP, JavaScript などの言語変換サポート
4. **インタラクティブな変換ガイド**：ユーザーが手動で修正できるインタラクティブなガイド
5. **パフォーマンス最適化**：変換されたコードのパフォーマンス向上のための最適化
6. **大規模プロジェクト対応**：複数ファイルと依存関係を持つ大規模 Perl プロジェクトの変換

## 貢献方法

1. リポジトリをフォークする
2. 機能ブランチを作成する（`git checkout -b feature/amazing-feature`）
3. 変更をコミットする（`git commit -m 'Add some amazing feature'`）
4. ブランチにプッシュする（`git push origin feature/amazing-feature`）
5. プルリクエストを開く

## ライセンス

このプロジェクトは MIT ライセンスの下で提供されています - 詳細は [LICENSE](LICENSE) ファイルを参照してください。

## 謝辞

- このプロジェクトは [Manus-Like Agent](https://github.com/raspverry/manus-like-agent) をベースにしています
- PPI (Perl Parsing Interface) による Perl コード解析
- OpenAI API によるコード生成と解析
- LangChain フレームワークによる LLM 統合
